# Git Worktree Utilities

Набор утилит для автоматизации работы с **Git Worktrees**. Упрощает создание изолированных окружений для параллельной разработки.

## Единый CLI: `wt`

Все утилиты доступны через единую команду `wt`.

### Команды

| Команда | Алиасы | Описание |
| :--- | :--- | :--- |
| `wt new <name>` | `create` | Создать новую задачу (ветку + папку + setup) |
| `wt list` | `ls` | Показать список активных worktrees |
| `wt kill <name>` | `rm` | Удалить worktree (добавьте `-D` для удаления ветки) |
| `wt setup` | `init` | Настроить/обновить окружение в текущей папке |

### Конфигурация (`.worktree-config`)

При создании (`new`) или настройке (`setup`) ворктри, скрипт читает файл `.worktree-config` из **основного (main)** репозитория и применяет правила к текущей папке.

**Формат файла:**
Каждая строка — это инструкция. Синтаксис: `КОМАНДА АРГУМЕНТ`.

| Команда | Описание | Пример использования |
| :--- | :--- | :--- |
| `LINK` | Создает симлинк на файл/папку из основного репозитория. (По умолчанию, если команда не указана). | Общие скрипты, конфиги IDE, `.gitignore`. |
| `COPY` | Копирует файл из основного репозитория. Полезно для шаблонов, которые должны быть независимыми в каждом ворктри. | `.env`, локальные конфиги базы данных. |
| `RUN` | Выполняет shell-команду внутри ворктри после создания файлов. | `npm install`, `composer install`. |

**Пример `.worktree-config`:**
```text
# === Ссылки (Shared Resources) ===
# Просто имя файла = LINK (симлинк)
scripts
LINK .geminiignore

# === Копии (Independent Configs) ===
# Копируем .env, чтобы в каждом ворктри можно было менять переменные,
# не ломая настройки в других папках.
COPY .env

# === Действия (Actions) ===
# Устанавливаем зависимости сразу после создания
RUN npm install
```

> **Примечание:** Также автоматически создаются симлинки для всех файлов, перечисленных в `.git/info/exclude` (локальный игнор-лист git), если они существуют в основном репозитории.

## Установка

### Быстрый старт (в текущий проект)
Чтобы добавить утилиты в конкретный проект, выполните в корне репозитория:
```bash
curl -fsSL https://raw.githubusercontent.com/vladislavlozhkin/worktree-utils/main/install.sh | bash
```
Это создаст папку `scripts/` с утилитами и файл конфигурации `.worktree-config`.

### Глобальная установка (для разработки)
Если вы клонировали этот репозиторий и хотите использовать `wt` глобально:

```bash
mkdir -p ~/bin
ln -sf "$(pwd)/scripts/wt" ~/bin/wt
```
*(Убедитесь, что `~/bin` есть в вашем PATH)*

## Пример Workflow

```bash
# 1. Начать новую задачу
wt new feature/awesome-bot

# 2. (Внутри папки) Если изменили конфиги или нужно пересобрать
wt setup

# 3. Посмотреть, где мы
wt list

# 4. Завершить работу (удалить папку и ветку)
wt rm feature/awesome-bot -D
```
