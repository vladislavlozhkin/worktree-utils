# Git Worktree Utilities

Этот проект представляет собой набор утилит для упрощения и автоматизации работы с **Git Worktrees**. 

Основная цель — устранить рутинные операции при создании изолированных рабочих окружений. Это особенно актуально при использовании AI-агентов (Gemini, Claude) для параллельной разработки, когда требуется быстро создать изолированный контекст с сохранением доступа к локальным конфигурациям и секретам.

## Инструменты

### 1. `scripts/ai-link` (Environment Linker)

Скрипт для синхронизации окружения.

При создании "чистого" worktree (`git worktree add`) вы получаете состояние файлов из git, но теряете локальные неотслеживаемые файлы (untracked files), такие как `.env`, `.geminiignore`, `CLAUDE.md` или локальные скрипты. `ai-link` решает эту проблему.

**Функциональность:**
*   Автоматически находит "Главный worktree" (Main Worktree) проекта.
*   Создает символические ссылки (symlinks) в текущем worktree на файлы из главного.
*   Использует **`.git/info/exclude`** как основной источник конфигурации.
*   Поддерживает дополнительный конфиг `.worktree-links`.

### 2. `scripts/wt-new` (Quick Start)

Обертка для быстрого создания нового рабочего пространства.

**Назначение:**
Минимизирует количество команд для начала новой задачи.
*   Принимает имя ветки/задачи.
*   Создает директорию для worktree (по стандартизированному пути).
*   Создает новую git-ветку.
*   **Автоматически запускает `ai-link`** внутри нового worktree, подготавливая его к немедленной работе.

### 3. `scripts/wt-kill` (Smart Cleanup)

Утилита для быстрого удаление ненужных worktree.

**Назначение:**
Решает проблему "замусоривания" диска после экспериментов AI.
*   Позволяет удалить worktree, даже если в нем остались неотслеживаемые файлы (логи, артефакты сборки), которые обычно блокируют `git worktree remove`.
*   Удаление ветки происходит **только при явном указании флага** (безопасность).

**Использование:**
```bash
wt-kill feature/login      # Удалит только папку worktree
wt-kill feature/login -D   # Удалит папку worktree И саму ветку
```

### 4. `scripts/wt-list` (Navigator)

Информационная панель для активных окружений.

**Назначение:**
Улучшает стандартный `git worktree list`, предоставляя больше контекста:
*   Показывает статус ветки (насколько она отстает или опережает main).
*   Помогает ориентироваться, какие worktree "заброшены", а какие активны.

## Установка и Глобальный доступ

Для комфортной работы рекомендуется сделать утилиты доступными глобально.

### Вариант 1: Символические ссылки в `~/bin` (Рекомендуется)
Этот способ позволяет вызывать команды `wt-new`, `wt-kill` и т.д. из любого места терминала.

```bash
mkdir -p ~/bin
# Находясь в корне этого репозитория:
ln -sf "$(pwd)/scripts/ai-link" ~/bin/ai-link
ln -sf "$(pwd)/scripts/wt-new" ~/bin/wt-new
ln -sf "$(pwd)/scripts/wt-kill" ~/bin/wt-kill
ln -sf "$(pwd)/scripts/wt-list" ~/bin/wt-list
```
*Убедитесь, что `~/bin` находится в вашем `$PATH`.*

### Вариант 2: Добавление в PATH
Добавьте абсолютный путь к папке `scripts` в ваш `.zshrc` или `.bashrc`:
```bash
export PATH="$PATH:/path/to/this/repo/scripts"
```

## Использование

```bash
# 1. Создание новой задачи (ветки и папки) + автонастройка окружения
wt-new feature/new-ui

# 2. Просмотр списка активных worktrees
wt-list

# 3. Удаление worktree и ветки после завершения
wt-kill feature/new-ui -D
```

## Статус разработки

*   [x] `ai-link` — Связывание конфигов
*   [x] `wt-new` — Создание окружения
*   [x] `wt-kill` — Очистка
*   [x] `wt-list` — Навигация
